var questionBank = [
    //Q1
    {
      question: "I'm very happy _____ in India. I really miss being there.",
      option: [
        "to have lived",
        " to be lived",
        "to be living",
        "to have lived",
      ],
      answer: "to have lived",
    },
    //Q2
  
    {
      question: "They didn't reach an agreement ______ their differences",
      option: [
        "on account of",
        "due",
        "because",
        "owing",
      ],
      answer: "on account of",
    },
    //Q3
  
    {
      question: "I wish I _____ those words. But now it's too late.",
      option: [
        "not having said",
        "have never said",
        "never said",
        " had never said",
      ],
      answer: "had never said",
    },
    //Q4
  
    {
      question: "The woman, who has been missing for 10 days, is believed _____.",
      option: [
        "to be abducted",
        "to be abducting",
        "to have been abducted",
        "to have been abducting",
      ],
      answer: "to have been abducted",
    },
    //Q4
  
    {
      question: "She was working on her computer with her baby next to _____.",
      option: [
        "herself",
        "her",
        "her own",
        "hers",
      ],
      answer: "her",
    },
    //Q5
  
    {
      question: "_____ to offend anyone, she said both cakes were equally good."
      ,
      option: [
        "Not wanting",
        "As not wanting",
        "She didn't want",
        "Because not wanting",
      ],
      answer: "Not wanting",
    },
    //Q6
  
    {
      question: "_____ in trying to solve this problem. It's clearly unsolvable.",
      option: [
        "There's no point",
        "It's no point",
        "There isn't poin",
        "It's no need",
      ],
      answer: "There's no point",
    },
    //Q7
  
    {
      question: "Last year, when I last met her, she told me she _____ a letter every day for the last two months.",
      option: [
        "had written",
        "has written",
        'had been writing',
        "wrote",
      ],
      answer: "had been writing",
    },
    //Q8
    {
      question: "He _____ robbed as he was walking out of the bank. ",
      option: [
        "had",
        "did",
        "got",
        "were",
      ],
      answer: "got",
    },
    //Q9
  
    {
      question: "_____ forced to do anything. He acted of his own free will. ",
      option: [
        "In no way was he",
        "No way he was",
        "In any way he was",
        "In any way was he",
      ],
      answer: "In no way was he",
    },
    //Q10
  
    {
      question:
        "It _____ the best idea to pay for those tickets by credit card. It was too risky.",
      option: ["may not have been", "may not be",
       "may not be",
        "must not have been"],
      answer: "may not have been",
    },
    //Q11
    {
      question:
        "They _____ in the basement for three months.",
      option: ["were made sleeping", "were made sleep",
       "made to sleep", 
       "were made to sleep"],
      answer: "were made to sleep",
    },
    //Q12
    {
      question:
        "We'll never know what might have happened _____ the email earlier.",
      option: ["if he sent", "had he sent",
      
      "if he has sent", 
      "did he sent"],
      answer: "had he sent",
    },
    //Q13
    {
      question:
        "What is the comparative form of the adjective 'good'?",
      option: ["well", "better", "best", "gooder"],
      answer: "better",
    },
    //Q14
    {
      question:
        "Choose the correct form of the verb: She _____ to the store.",
      option: ["goes", "go", "gone", "going"],
      answer: "goes",
    },
    //Q15
    {
      question:
        "______ gifts to the judges.",
      option: [" It's not allowed offering", "It's not permitted to offer",
       "It's not permitted offering", " It's not allowed to offer"],
      answer: "It's not permitted to offer",
    },
    //Q16
    {
      question:
      "What is the plural form of child?",
      option: ["childs", "children", "childes", "cildren"],
      answer: "children",
    },
    //Q17
    {
      question:
      "Which word is the opposite of brave?",
      option: ["fearless", "timid", "courageous", "daring"],
      answer: "timid",
    },
    //Q18
    {
      question:
      "What is the correct spelling?",
      option: ["Neccessary", "Necesary", "Necessarry", " Necessary"],
      answer: "Necessary",
    },
    //Q19
    {
      question:
      "Choose the correct sentence:",
      option: ["The cat lays on the mat.", "The cat lied on the mat.", "The cat lies on the mat.",
       "The cat lain on the mat."],
      answer: "The cat lies on the mat.",
    },
    //Q20
    {
      question:
      "What is the past tense of sing?",
      option: ["sang", "sung", "singed", "sings"],
      answer: "sang",
    },
    //Q21
    {
      question:
      "Which word is a noun?",
      option: ["happy", "quickly", "apple", "slowly"],
      answer: "apple",
    },
    //Q22
    {
      question:
      "What is the synonym for angry?",
      option: ["happy", "sad", "mad", "calm"],
      answer: "mad",
    },
    //Q23
    {
      question:
      "What is the superlative form of big?",
      option: ["biger", "bigest", "biggest", "more big"],
      answer: "biggest",
    },
    //Q24
    {
      question:
        "Identify the correct sentence structure:",
      option: ["Me and my brother are going to the park", "My brother and me are going to the park.", "My brother and I are going to the park", "I and my brother are going to the park."],
      answer: "My brother and I are going to the park",
    },
    //Q24
    {
      question:
      "What is the synonym for beautiful?",
      option: ["ugly", "pretty", "lovely", "nice"],
      answer: "pretty",
    },
    //Q26
    {
      question:
      "Choose the correctly spelled word:",
      option: ["reseive", "recieve", "receive", "recive"],
      answer: "receive",
    },
    //Q27
    {
      question:
      "Which sentence is in the present perfect tense?",
      option: ["I will go to the store tomorrow.", "I went to the store yesterday.", "I go to the store every day.", "I have gone to the store."],
      answer: "I have gone to the store.",
    },
    //Q28
    {
      question:
        "Which of the following CSS selectors are used to specify a group of elements? ",
      option: ["an car", "an cat", "a car", "a elephant"],
      answer: "a car",
    },
    //Q29
    {
      question:
      "What is the comparative form of bad?",
      option: ["baddest", "badder", "worse", " both class and tag"],
      answer: "class",
    },
    //Q30
    {
      question:
        "Which of the following CSS selectors are used to specify a group of elements? ",
      option: ["tag", "id", "class", " both class and tag"],
      answer: "class",
    },
  ];
  // console.log(questionBank.length);
  var question = document.getElementById("question");
  var quizContainer = document.getElementById("quiz-container");
  var scorecard = document.getElementById("scoreboard");
  var option0 = document.getElementById("optiona");
  var option1 = document.getElementById("optionb");
  var option2 = document.getElementById("optionc");
  var option3 = document.getElementById("optiond");
  var next = document.querySelector(".next");
  var points = document.getElementById("score");
  
  var span = document.querySelectorAll("label");
  var i = 0;
  var selectedAnswers = [];
  var score = 0;
  var optiond0=document.getElementById('option0')
  var optiond1=document.getElementById('option1')
  var optiond2=document.getElementById('option2')
  var optiond3=document.getElementById('option3')
  
  var savedTime = localStorage.getItem("timer1");
  var timeInSecs1 = savedTime ? parseInt(savedTime) : 20 * 60; // Default to 10 minutes if no saved time exists
  var ticker;
  function shuffle(array) {
    
  // for there remain elements to shuffle.
    for (let i = array.length - 1; i > 0; i--) {
      // Pick a remaining element.
      const j = Math.floor(Math.random() * (i + 1));
      // And swap it with the current element.
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }
   questionBank= shuffle(questionBank);
  var questionCount = 0;
  
  function startTimer(secs) {
    timeInSecs = parseInt(secs);
    ticker = setInterval(tick, 1000);
  }

  //function to display questions
  function displayQuestion() {
    if (questionCount < 15) {
      question.innerHTML = questionCount + 1 + " " + questionBank[i].question;
      questionCount++;
    
    for (var a = 0; a < span.length; a++) {
      span[a].style.background = "none";
     
    }
    option0.innerHTML = questionBank[i].option[0];
    optiond0.checked = false; // Set checked attribute to false

    option1.innerHTML = questionBank[i].option[1];
    optiond1.checked = false; // Set checked attribute to false

    option2.innerHTML = questionBank[i].option[2];
    optiond2.checked = false; // Set checked attribute to false

    option3.innerHTML = questionBank[i].option[3];
    optiond3.checked = false; // Set checked attribute to false

    stat.innerHTML = "Question " + (questionCount ) + " of 15";}
    else{
      points.innerHTML = score + "/" +15;
      quizContainer.style.display = "none";
      scorecard.style.display = "block";
    }
    localStorage.setItem("timer1", i.toString());
  }
  
  //function to calculate scores
  function calcScore(e) {
    if (e.innerHTML === questionBank[i].answer ) {
      score = score + 1;
      
    }
    //setTimeout(nextQuestion);
  
    selectedAnswers[i] = e.innerHTML;
  }
  
  //function to display next question
  function nextQuestion() {
    if (i < questionBank.length ) {
      i = i + 1;
      displayQuestion();
      
    } else
     {
      points.innerHTML = score + "/" + 15;
      quizContainer.style.display = "none";
      scorecard.style.display = "block";
    
   
    
    localStorage.setItem("timer1", i.toString());
  }}
  
  //click events to next button
  next.addEventListener("click", nextQuestion);
  
  //Back to Quiz button event
  function backToQuiz() {
    localStorage.removeItem("questionIndex");
    localStorage.removeItem("timer1");
    window.location.href = "dashboard.html";
    //location.reload();
  }
  //function to check Answers
  function checkAnswer() {
    var answerBank = document.getElementById("answerBank");
    var answers = document.getElementById("answers");
    answerBank.style.display = "block";
    scorecard.style.display = "none";
    for (var a = 0; a < questionBank.length; a++) {
      var list = document.createElement("li");
      list.innerHTML = questionBank[a].answer;
      answers.appendChild(list);
      showSelectedAnswers();
    }
  }
  
  function showSelectedAnswers() {
    var answerBank = document.getElementById("answerBank");
    var answers = document.getElementById("answers");
    answerBank.style.display = "block";
    scorecard.style.display = "none";
    answers.innerHTML = ""; // Clear the answers list
  
    for (var a = 0; a < questionCount ; a++) {
      if (selectedAnswers[a]) {
        var list = document.createElement("li");
        list.innerHTML = `  <div class="question bg-white p-5 border-bottom">
            <div class="d-flex flex-row align-items-center question-title">
                <h4 class="text custtext-danger tt">${questionBank[a].question}</h4>
              
            </div>
          
            <ul class="list-group list-group-flush">
            
            <li class="list-group-item  option"><span id="option1" ><b>Your Answer:</b> ${selectedAnswers[a]}</span></li>
            <li class="list-group-item option"><span id="option2"></span> <b>The correct answer:</b> ${questionBank[a].answer}</li>
      
           </ul>`;
  
        answers.appendChild(list);
      }
    }
  }
  let done=document.getElementById("score-btn")
  let array = JSON.parse(localStorage.getItem("users"));
  let currentUser = JSON.parse(localStorage.getItem("currentUser"));
  console.log("array-------")
  console.log(array)
  console.log("currentUser-------")
  console.log(currentUser)
  

 var checkanswer =document.getElementById("check-answer")
  function updateInfo(){
  
         
          // currentUser.progressbar +=33;
       
          currentUser.englishFlag = true;
       currentUser.englishScore= score;
     console.log(score);
          //to add value of current user(before was: null)
          
      // }
      const updateArr = array.map((ele) => {
          return ele.email === currentUser.email
            ? {
                ...ele, //just update on key of the elements
                progressbar:currentUser.progressbar,
             
                englishScore:currentUser.englishScore,
                englishFlag: true,
                
              }
            : ele;
        });
  
        localStorage.setItem("users", JSON.stringify(updateArr));
    
        localStorage.setItem("currentUser", JSON.stringify(currentUser));
  }
  done.addEventListener("click", updateInfo);
  checkanswer.addEventListener("click", updateInfo);
  function startTimer(secs) {
    timeInSecs1 = parseInt(secs);
    ticker = setInterval(tick, 1000);
  }
  function tick() {
    var secs = timeInSecs1;
    if (secs > 0) {
      timeInSecs1--;
      localStorage.setItem("timer1", timeInSecs1.toString()); // Save the updated time in local storage
    } else {
      clearInterval(ticker);
      localStorage.removeItem("timer1"); // Clear the timer from local storage when it reaches 0
      window.location.href = "dashboard.html";
      // Restart the timer with a duration of 10 minutes
    }
  
    var mins = Math.floor(secs / 60);
    secs %= 60;
  
    var result =
      (mins < 20 ? "" : "") + mins + ":" + (secs < 20 ? "" : "") + secs;
  
    document.getElementById("countdown").innerHTML = "Timer: " + result;
  }
  
  startTimer(timeInSecs1); // 5 minutes in seconds
  

  displayQuestion();